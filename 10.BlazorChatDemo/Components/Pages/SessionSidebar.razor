@using static BlazorChatDemo.Components.Pages.Chat

<div class="sidebar">
    <div class="sidebar-header">
        <h2 class="sidebar-title">Chats</h2>
        <button class="new-chat-btn" @onclick="OnNewChat" title="New Chat">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z" fill="currentColor"/>
            </svg>
        </button>
    </div>

    <div class="session-list">
        @foreach (var session in Sessions)
        {
            <button class="session-item @(session.Id == ActiveSessionId ? "active" : "")"
                    @onclick="() => OnSessionSelected.InvokeAsync(session.Id)">
                <div class="session-icon">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                        <path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z" fill="currentColor"/>
                    </svg>
                </div>
                <div class="session-info">
                    <span class="session-name">@session.Title</span>
                    <span class="session-meta">@session.Messages.Count message@(session.Messages.Count == 1 ? "" : "s")</span>
                </div>
                @if (Sessions.Count > 1)
                {
                    <button class="session-delete" @onclick="() => OnSessionDeleted.InvokeAsync(session.Id)" @onclick:stopPropagation="true" title="Delete">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none">
                            <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" fill="currentColor"/>
                        </svg>
                    </button>
                }
            </button>
        }
    </div>
</div>

@code {
    [Parameter] public IReadOnlyList<ChatSessionInfo> Sessions { get; set; } = [];
    [Parameter] public string? ActiveSessionId { get; set; }
    [Parameter] public EventCallback OnNewChat { get; set; }
    [Parameter] public EventCallback<string> OnSessionSelected { get; set; }
    [Parameter] public EventCallback<string> OnSessionDeleted { get; set; }
}
